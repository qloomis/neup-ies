

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>simulations.dispatch.NuclearDispatch &#8212; NE-2 Simulations  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bizstyle.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">NE-2 Simulations  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">simulations.dispatch.NuclearDispatch</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for simulations.dispatch.NuclearDispatch</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Pyomo real-time dispatch model</span>


<span class="sd">Model authors:</span>
<span class="sd">* Mike Wagner - UW-Madison</span>
<span class="sd">* Bill Hamilton - NREL </span>
<span class="sd">* John Cox - Colorado School of Mines</span>
<span class="sd">* Alex Zolan - NREL</span>

<span class="sd">Pyomo code by Alex Zolan</span>
<span class="sd">Modified by Gabriel Soto</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">pyomo.environ</span> <span class="k">as</span> <span class="nn">pe</span>
<span class="kn">from</span> <span class="nn">dispatch.GeneralDispatch</span> <span class="kn">import</span> <span class="n">GeneralDispatch</span>
<span class="kn">from</span> <span class="nn">dispatch.GeneralDispatch</span> <span class="kn">import</span> <span class="n">GeneralDispatchParamWrap</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">util.FileMethods</span> <span class="kn">import</span> <span class="n">FileMethods</span>
<span class="kn">from</span> <span class="nn">util.SSCHelperMethods</span> <span class="kn">import</span> <span class="n">SSCHelperMethods</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">copy</span>

<div class="viewcode-block" id="NuclearDispatch"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch">[docs]</a><span class="k">class</span> <span class="nc">NuclearDispatch</span><span class="p">(</span><span class="n">GeneralDispatch</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The NuclearDispatch class is meant to set up and run Dispatch</span>
<span class="sd">    optimization as a mixed integer linear program problem using Pyomo,</span>
<span class="sd">    specifically for the NuclearTES NE2+SSC module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="NuclearDispatch.__init__"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the NuclearDispatch module</span>
<span class="sd">        </span>
<span class="sd">        The instantiation of this class receives a parameter dictionary from</span>
<span class="sd">        the NE2 module (created using the NuclearDispatchWrapper class). It calls</span>
<span class="sd">        on the GeneralDispatch __init__ to create the model. The GeneralDispatcher first</span>
<span class="sd">        creates an empty Concrete Model from Pyomo, then generates Parameters</span>
<span class="sd">        from the parameter dictionary, Variables, Objectives and Constraints.</span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            params (dict)                : dictionary of Pyomo dispatch parameters</span>
<span class="sd">            unitRegistry (pint.registry) : unique unit Pint unit registry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="NuclearDispatch.generate_params"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.generate_params">[docs]</a>    <span class="k">def</span> <span class="nf">generate_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">skip_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to generate parameters within Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method reads in a dictionary of pyomo parameters and uses these</span>
<span class="sd">        inputs to initialize parameters for the Pyomo Concrete Model. This method</span>
<span class="sd">        sets up parameters particularly for the Power Cycle. It also defines</span>
<span class="sd">        some lambda functions that helps convert Pint units to Pyomo units. It</span>
<span class="sd">        first instantiates PowerCycle parameters through GeneralDispatch, then</span>
<span class="sd">        instantiates Nuclear parameters.</span>
<span class="sd">        </span>
<span class="sd">        Note: initial conditions are defined for the time period immediately </span>
<span class="sd">        preceding the start of this new Pyomo time segment. </span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            params (dict)  : dictionary of Pyomo dispatch parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generate_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="c1"># lambdas to convert units and data to proper syntax</span>
        <span class="n">gd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gd</span>
        <span class="n">gu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gu</span> 
        
        <span class="c1">### Cost Parameters ### </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Cnuc</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Cnuc&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Cnuc&quot;</span><span class="p">))</span>              <span class="c1">#C^{nuc}: Operating cost of nuclear plant [\$/kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Cnsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Cnsu&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Cnsu&quot;</span><span class="p">))</span>              <span class="c1">#C^{nsu}: Penalty for nuclear cold start-up [\$/start]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Cnhsp</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Cnhsp&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Cnhsp&quot;</span><span class="p">))</span>           <span class="c1">#C^{nhsp}: Penalty for nuclear hot start-up [\$/start]</span>
        
        <span class="c1">### Objective Function Coefficients ###</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_p</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_p&quot;</span><span class="p">))</span>          <span class="c1">#e^{P}: Profit obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_pcsu&quot;</span><span class="p">))</span>    <span class="c1">#e^{pcsu}: PC SU obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pchsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_pchsu&quot;</span><span class="p">))</span>  <span class="c1">#e^{pchsu}: PC Hot SU obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcsd</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_pcsd&quot;</span><span class="p">))</span>    <span class="c1">#e^{pcsd}: PC SD obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcr</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_pcr&quot;</span><span class="p">))</span>      <span class="c1">#e^{pcr}: PC ramp obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcer</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_pcer&quot;</span><span class="p">))</span>    <span class="c1">#e^{pcer}: PC excess ramp obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_nsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_nsu&quot;</span><span class="p">))</span>      <span class="c1">#e^{nsu}: Nuclear SU obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_nhsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_nhsu&quot;</span><span class="p">))</span>    <span class="c1">#e^{nhsu}: Nuclear Hot SU obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_nsd</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_nsd&quot;</span><span class="p">))</span>      <span class="c1">#e^{nsd}: Nuclear SD obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcg</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_pcg&quot;</span><span class="p">))</span>      <span class="c1">#e^{pcg}: PC gen obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcsb</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_pcsb&quot;</span><span class="p">))</span>    <span class="c1">#e^{pcsb}: PC SB obj func coefficient [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ec_nt</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ec_nt&quot;</span><span class="p">))</span>        <span class="c1">#e^{nt}: Nuclear production obj func coefficient [-]</span>
        
        <span class="c1">### Nuclear Parameters ###</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">deltanl</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;deltanl&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;deltanl&quot;</span><span class="p">))</span> <span class="c1">#\delta^{nl}: Minimum time to start the nuclear plant [hr]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">En</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;En&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;En&quot;</span><span class="p">))</span>                <span class="c1">#E^n: Required energy expended to start nuclear plant [kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Ln</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Ln&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Ln&quot;</span><span class="p">))</span>                <span class="c1">#L^n: Nuclear pumping power per unit power produced [kWe/kWt]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Qnl</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Qnl&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Qnl&quot;</span><span class="p">))</span>             <span class="c1">#Q^{nl}: Minimum operational thermal power delivered by nuclear [kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Qnsb</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Qnsb&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Qnsb&quot;</span><span class="p">))</span>          <span class="c1">#Q^{nsb}: Required thermal power for nuclear standby [kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Qnsd</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Qnsd&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Qnsd&quot;</span><span class="p">))</span>          <span class="c1">#Q^{nsd}: Required thermal power for nuclear shut down [kWt$\cdot$h] </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Qnu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Qnu&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Qnu&quot;</span><span class="p">))</span>             <span class="c1">#Q^{nu}: Allowable power per period for nuclear start-up [kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Wnht</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Wnht&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Wnht&quot;</span><span class="p">))</span>          <span class="c1">#W^{nht}: Nuclear piping heat trace parasitic loss [kWe]</span>

        <span class="c1">### Time series Nuclear Parameters ###</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">delta_ns</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;delta_ns&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;delta_ns&quot;</span><span class="p">))</span>     <span class="c1">#\delta^{ns}_{t}: Estimated fraction of period $t$ required for nuclear start-up [-]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Qin_nuc</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;Qin_nuc&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;Qin_nuc&quot;</span><span class="p">))</span>        <span class="c1">#Q^{in,nuc}_{t}: Available thermal power generated by the nuclear plant in period $t$ [kWt]</span>
        
        <span class="c1">### Initial Condition Parameters ###</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">unsu0</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;unsu0&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;unsu0&quot;</span><span class="p">))</span>  <span class="c1">#u^{nsu}_0: Initial nuclear start-up energy inventory [kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">yn0</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;yn0&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;yn0&quot;</span><span class="p">))</span>        <span class="c1">#y^n_0: 1 if nuclear is generating ``usable&#39;&#39; thermal power initially, 0 otherwise  [az] this is new.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsb0</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ynsb0&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;ynsb0&quot;</span><span class="p">))</span>  <span class="c1">#y^{nsb}_0: 1 if nuclear is in standby mode initially, 0 otherwise [az] this is new.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsu0</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="n">gd</span><span class="p">(</span><span class="s2">&quot;ynsu0&quot;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">gu</span><span class="p">(</span><span class="s2">&quot;ynsu0&quot;</span><span class="p">))</span>  <span class="c1">#y^{nsu}_0: 1 if nuclear is in starting up initially, 0 otherwise [az] this is new.</span></div>
        

<div class="viewcode-block" id="NuclearDispatch.generate_variables"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.generate_variables">[docs]</a>    <span class="k">def</span> <span class="nf">generate_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to generate parameters within Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method instantiates variables for the Pyomo Concrete Model, with</span>
<span class="sd">        domains. Does not need initial guesses here, they are defined in the </span>
<span class="sd">        parameters. We first define continuous and binary variables for the </span>
<span class="sd">        Power Cycle through GeneralDispatch, then declare nuclear variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generate_variables</span><span class="p">()</span>

        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pyomo</span>
        <span class="c1">### Decision Variables ###</span>
        <span class="c1">#------- Variables ---------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">unsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">kWh</span><span class="p">)</span>     <span class="c1">#u^{nsu}: Nuclear start-up energy inventory at period $t$ [kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">xn</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">kW</span><span class="p">)</span>	    <span class="c1">#x^n: Thermal power delivered by the nuclear at period $t$ [kWt]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">xnsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">kW</span><span class="p">)</span>      <span class="c1">#x^{nsu}: Nuclear start-up power consumption at period $t$ [kWt]</span>
        
        <span class="c1">#------- Binary Variables ---------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">yn</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>        <span class="c1">#y^n: 1 if nuclear is generating ``usable&#39;&#39; thermal power at period $t$; 0 otherwise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynhsp</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>	  <span class="c1">#y^{nhsp}: 1 if nuclear hot start-up penalty is incurred at period $t$ (from standby); 0 otherwise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsb</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>	  <span class="c1">#y^{nsb}: 1 if nuclear is in standby mode at period $t$; 0 otherwise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsd</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>	  <span class="c1">#y^{nsd}: 1 if nuclear is shut down at period $t$; 0 otherwise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsu</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>      <span class="c1">#y^{nsu}: 1 if nuclear is starting up at period $t$; 0 otherwise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsup</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">pe</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>     <span class="c1">#y^{nsup}: 1 if nuclear cold start-up penalty is incurred at period $t$ (from off); 0 otherwise</span></div>


<div class="viewcode-block" id="NuclearDispatch.add_objective"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.add_objective">[docs]</a>    <span class="k">def</span> <span class="nf">add_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to add an objective function to the Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method adds an objective function to the Pyomo Nuclear Dispatch</span>
<span class="sd">        model. Typically, the LORE team defined a nested function and passes it</span>
<span class="sd">        into the Pyomo model. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">objectiveRule</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Maximize profits vs. costs &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                    <span class="nb">sum</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">D</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> 
                    <span class="c1">#obj_profit</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ec_p</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wdot_s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">wdot_p</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
                    <span class="c1">#obj_cost_cycle_su_hs_sd</span>
                    <span class="o">-</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcsu</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Ccsu</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsup</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ec_pchsu</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Cchsp</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ychsp</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ec_pcsd</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">alpha</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsd</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
                    <span class="c1">#obj_cost_cycle_ramping</span>
                    <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcr</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">C_delta_w</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wdot_delta_plus</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">model</span><span class="o">.</span><span class="n">wdot_delta_minus</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ec_pcer</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">C_v_w</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wdot_v_plus</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">wdot_v_minus</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span>
                    <span class="c1">#obj_cost_nuc_su_hs_sd</span>
                    <span class="o">-</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ec_nsu</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Cnsu</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynsup</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ec_nhsu</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Cnhsp</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynhsp</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ec_nsd</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">alpha</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynsd</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
                    <span class="c1">#obj_cost_ops</span>
                    <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcg</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Cpc</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">wdot</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ec_pcsb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Ccsb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Qb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ec_nt</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">Cnuc</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">xn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> 
                    <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objectiveRule</span><span class="p">,</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">maximize</span><span class="p">)</span></div>


<div class="viewcode-block" id="NuclearDispatch.addNuclearStartupConstraints"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.addNuclearStartupConstraints">[docs]</a>    <span class="k">def</span> <span class="nf">addNuclearStartupConstraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to add nuclear startup constraints to the Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method adds constraints pertaining to nuclear reactor startup within the </span>
<span class="sd">        Pyomo Nuclear Dispatch class. Several nested functions are defined. We don&#39;t</span>
<span class="sd">        model nuclear reactor startup in SSC, this is kept for completeness&#39; sake. This</span>
<span class="sd">        is essentially used as a sanity check, if Pyomo deems that nuclear should shutdown</span>
<span class="sd">        or startup then something is wrong and SSC will complain. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">nuc_inventory_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP energy inventory for startup is balanced &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">unsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">unsu0</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">xnsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">unsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">unsu</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">xnsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_inv_nonzero_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP energy inventory is positive if starting up &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">unsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">En</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_startup_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP resumes normal operation after startup or if previously operating &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">unsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">En</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">yn0</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb0</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">unsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">En</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_su_persist_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP cannot startup if operating in previous timestep &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">yn0</span> <span class="o">&lt;=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span>  <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span>
        <span class="k">def</span> <span class="nf">ramp_limit_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP must abide by ramp rate limits &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">xnsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnu</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nontrivial_nuclear_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP trivial power prevents startup &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Qin_nuc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnl</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_inventory_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_inventory_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_inv_nonzero_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_inv_nonzero_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_startup_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_startup_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_su_persist_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_su_persist_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_ramp_limit_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">ramp_limit_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nontrivial_nuclear_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nontrivial_nuclear_rule</span><span class="p">)</span></div>
        
        
<div class="viewcode-block" id="NuclearDispatch.addNuclearSupplyAndDemandConstraints"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.addNuclearSupplyAndDemandConstraints">[docs]</a>    <span class="k">def</span> <span class="nf">addNuclearSupplyAndDemandConstraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to add nuclear supply and demand constraints to the Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method adds constraints pertaining to nuclear supply and demand energy</span>
<span class="sd">        constraints. Some constraints might be redundant, they are adapted from the CSP</span>
<span class="sd">        constraints (thanks LORE team).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">nuc_production_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Upper bound on thermal energy produced by NP &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">xn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">xnsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnsd</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynsd</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Qin_nuc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_generation_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Thermal energy production by NP only when operating &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">xn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Qin_nuc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_min_generation_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Lower bound on thermal energy produced by NP &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">xn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnl</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_gen_persist_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP not able to operate if no thermal power (adapted from CSP) &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Qin_nuc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnl</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_production_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_production_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_generation_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_generation_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_min_generation_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_min_generation_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_gen_persist_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_gen_persist_rule</span><span class="p">)</span></div>
        
        
<div class="viewcode-block" id="NuclearDispatch.addNuclearNodeLogicConstraints"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.addNuclearNodeLogicConstraints">[docs]</a>    <span class="k">def</span> <span class="nf">addNuclearNodeLogicConstraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to add nuclear logic constraints to the Pyomo General Model</span>
<span class="sd">        </span>
<span class="sd">        This method adds constraints pertaining to tracking binary variable</span>
<span class="sd">        logic for the nuclear plant. Essentially, to make sure the correct modes</span>
<span class="sd">        are activated when they are allowed. There is no Nuclear standby (nor CSP)</span>
<span class="sd">        so those particular constraints are also just for completeness sake. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">nuc_su_sb_persist_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP startup and standby cannot coincide &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span>
        <span class="k">def</span> <span class="nf">nuc_sb_persist_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP standby and operation cannot coincide &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span>
        <span class="k">def</span> <span class="nf">rsb_persist_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP standby must follow operating or another standby timestep &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">yn0</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb0</span><span class="p">)</span> 
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_su_pen_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP cold startup penalty &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsup</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu0</span> 
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsup</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">nuc_hs_pen_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP hot startup penalty: if we went from standby to operating &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynhsp</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynhsp</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">def</span> <span class="nf">nuc_shutdown_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; NP shutdown protocol &quot;&quot;&quot;</span>
            <span class="n">current_Delta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="c1"># structure of inequality is lb &lt;= model.param &lt;= ub with strict=False by default</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_ineq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">current_Delta</span><span class="p">)</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#not strict</span>
                <span class="k">return</span> <span class="mi">0</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">yn0</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span>  <span class="n">model</span><span class="o">.</span><span class="n">ynsb0</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_ineq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">current_Delta</span><span class="p">)</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># not strict</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsd</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_ineq</span><span class="p">(</span><span class="n">current_Delta</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsd</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">yn0</span>  <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb0</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="c1"># only case remaining: Delta[t]&lt;1, t&gt;1</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsd</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_su_sb_persist_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_su_sb_persist_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_sb_persist_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_sb_persist_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_rsb_persist_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">rsb_persist_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_su_pen_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_su_pen_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_hs_pen_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_hs_pen_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nuc_shutdown_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">nuc_shutdown_rule</span><span class="p">)</span></div>
        

<div class="viewcode-block" id="NuclearDispatch.addTESEnergyBalanceConstraints"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.addTESEnergyBalanceConstraints">[docs]</a>    <span class="k">def</span> <span class="nf">addTESEnergyBalanceConstraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to add TES constraints to the Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method adds constraints pertaining to TES energy balance from charging</span>
<span class="sd">        with thermal power and discharging to the power cycle. </span>
<span class="sd">        </span>
<span class="sd">        TODO: revisit tes_start_up_rule -&gt; do we need this for nuclear?</span>
<span class="sd">        TODO: do we need maintain_tes_rule?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">tes_balance_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Balance of energy to and from TES &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">s0</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">xn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Qc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnsb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">xn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Qc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnsb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span>
        <span class="k">def</span> <span class="nf">tes_upper_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Upper bound to TES charge state &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Eu</span>
        <span class="k">def</span> <span class="nf">tes_start_up_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Ensuring sufficient TES charge level to startup NP &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s0</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">delta_ns</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Qu</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="o">-</span><span class="mi">3</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ycsb0</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="p">)</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">delta_ns</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Qu</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="o">-</span><span class="mi">3</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">def</span> <span class="nf">maintain_tes_rule</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Final state of TES has to be less than or equal to start &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">num_periods</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">s0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tes_balance_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">tes_balance_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tes_upper_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">tes_upper_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tes_start_up_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">tes_start_up_rule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">maintain_tes_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">maintain_tes_rule</span><span class="p">)</span></div>


<div class="viewcode-block" id="NuclearDispatch.addPiecewiseLinearEfficiencyConstraints"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.addPiecewiseLinearEfficiencyConstraints">[docs]</a>    <span class="k">def</span> <span class="nf">addPiecewiseLinearEfficiencyConstraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to add efficiency constraints to the Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method adds constraints pertaining to efficiency constraints defined</span>
<span class="sd">        as a piecewise linear approximation. Also referred to as Cycle supply and </span>
<span class="sd">        demand constraints. In the NuclearDispatch, we add an extra balance of power</span>
<span class="sd">        with respect to energy storage and power produced from the nuclear reactor. </span>
<span class="sd">        </span>
<span class="sd">        TODO: This should be revisited when adding MED!!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">addPiecewiseLinearEfficiencyConstraints</span><span class="p">()</span>
        
        <span class="k">def</span> <span class="nf">grid_sun_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Balance of power flow, i.e. sold vs purchased &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">wdot_s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">wdot_p</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">etac</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">wdot</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                		<span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Ln</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">xn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">xnsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">Qnl</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
                		<span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Lc</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> 
                        <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Wb</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">Wnht</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>		<span class="c1">#Is Wrsb energy [kWh] or power [kW]?  [az] Wrsb = Wht in the math?</span>
            <span class="p">)</span>
        
        <span class="c1"># additional constraints</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">grid_sun_con</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">rule</span><span class="o">=</span><span class="n">grid_sun_rule</span><span class="p">)</span></div>


<div class="viewcode-block" id="NuclearDispatch.generate_constraints"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatch.generate_constraints">[docs]</a>    <span class="k">def</span> <span class="nf">generate_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to add ALL constraints to the Pyomo Nuclear Model</span>
<span class="sd">        </span>
<span class="sd">        This method calls the previously defined constraint methods to instantiate</span>
<span class="sd">        them and add to the existing model. This method first calls the GeneralDispatch</span>
<span class="sd">        version to set PowerCycle constraints, then calls nuclear constraint methods</span>
<span class="sd">        to add them to the model. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generate_constraints</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">addTESEnergyBalanceConstraints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addNuclearStartupConstraints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addNuclearSupplyAndDemandConstraints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addNuclearNodeLogicConstraints</span><span class="p">()</span></div></div>
        

    
<span class="c1"># =============================================================================</span>
<span class="c1"># Dispatch Wrapper</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="NuclearDispatchParamWrap"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchParamWrap">[docs]</a><span class="k">class</span> <span class="nc">NuclearDispatchParamWrap</span><span class="p">(</span><span class="n">GeneralDispatchParamWrap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The NuclearDispatchParamWrap class is meant to be the staging area for the </span>
<span class="sd">    creation of Parameters ONLY for the NuclearDispatch class. It communicates </span>
<span class="sd">    with the NE2 modules, receiving SSC and PySAM input dictionaries to calculate </span>
<span class="sd">    both static parameters used for every simulation segment AND initial conditions </span>
<span class="sd">    that can be updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="NuclearDispatchParamWrap.__init__"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchParamWrap.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the NuclearDispatchParamWrap module</span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            unitRegistry (pint.registry)   : unique unit Pint unit registry</span>
<span class="sd">            SSC_dict (dict)                : dictionary of SSC inputs needed to run modules</span>
<span class="sd">            PySAM_dict (dict)              : dictionary of PySAM inputs + file names</span>
<span class="sd">            pyomo_horizon (int Quant)      : length of Pyomo simulation segment (hours)</span>
<span class="sd">            dispatch_time_step (int Quant) : length of each Pyomo time step (hours)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="NuclearDispatchParamWrap.set_design"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchParamWrap.set_design">[docs]</a>    <span class="k">def</span> <span class="nf">set_design</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to calculate and save design point values of Plant operation</span>
<span class="sd">        </span>
<span class="sd">        This method extracts values and calculates for design point parameters </span>
<span class="sd">        of our Plant (e.g., nuclear thermal power output, power cycle efficiency,</span>
<span class="sd">        inlet and outlet temperatures, etc.). </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_design</span><span class="p">()</span>
        
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span>
        
        <span class="c1"># nuclear parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_nuc_design</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;q_dot_nuclear_des&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MW</span>      <span class="c1"># nuclear design thermal power</span>
        
        <span class="c1"># specific heat values at design point</span>
        <span class="n">T_htf</span>  <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T_htf_hot</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_htf_cold</span><span class="p">)</span>
        <span class="n">cp_des</span> <span class="o">=</span> <span class="n">SSCHelperMethods</span><span class="o">.</span><span class="n">get_cp_htf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">T_htf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;nuc_htf&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">cp_des</span> <span class="o">=</span> <span class="n">cp_des</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;J/g/kelvin&#39;</span><span class="p">)</span>       
        
        <span class="c1"># mass flow rate</span>
        <span class="n">dm_des</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_pb_design</span> <span class="o">/</span> <span class="p">(</span><span class="n">cp_des</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T_htf_hot</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_htf_cold</span><span class="p">)</span> <span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">dm_pb_design</span> <span class="o">=</span> <span class="n">dm_des</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kg/s&#39;</span><span class="p">)</span>                               <span class="c1"># power block design mass flow rate</span>
        
        <span class="c1"># TES design point</span>
        <span class="n">e_tes_design</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_pb_design</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;tshours&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">hr</span>  
        <span class="n">m_tes_des</span> <span class="o">=</span> <span class="n">e_tes_design</span> <span class="o">/</span> <span class="n">cp_des</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T_htf_hot</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_htf_cold</span><span class="p">)</span>     
        <span class="bp">self</span><span class="o">.</span><span class="n">e_tes_design</span> <span class="o">=</span> <span class="n">e_tes_design</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">)</span> <span class="c1"># TES storage capacity (kWht)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_tes_design</span> <span class="o">=</span> <span class="n">m_tes_des</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>     <span class="c1"># TES active storage mass (kg)</span></div>
        
        
<div class="viewcode-block" id="NuclearDispatchParamWrap.set_fixed_cost_parameters"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchParamWrap.set_fixed_cost_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_fixed_cost_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">,</span> <span class="n">skip_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set fixed costs of the Plant</span>
<span class="sd">        </span>
<span class="sd">        This method calculates some fixed costs for the Plant operations, startup,</span>
<span class="sd">        standby, etc. </span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            param_dict (dict) : dictionary of Pyomo dispatch parameters</span>
<span class="sd">        Outputs:</span>
<span class="sd">            param_dict (dict) : updated dictionary of Pyomo dispatch parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># grabbing unit registry set up in GeneralDispatch</span>
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span>
    
        <span class="c1"># set up costs from parent class</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_fixed_cost_parameters</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
        
        <span class="n">C_nuc</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;nuc_op_cost&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">USD</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">MWh</span>  <span class="c1"># value taken from Cory @ Westinghouse, later converted to $/kWh        </span>
        <span class="n">C_nsu</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;nuc_cold_su&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">USD</span>
        <span class="n">C_nhsp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;nuc_hot_su&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">USD</span>
        
        <span class="c1"># original nuc_op_cost given in MWh-electric rather than MWh-thermal</span>
        <span class="n">C_nuc</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta_design</span> <span class="c1"># eta =&gt; electric/thermal conversion</span>
        
        <span class="c1"># getting objective function coefficients</span>
        <span class="n">coeff_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ec_p&#39;</span><span class="p">,</span>     <span class="c1"># proft term</span>
                      <span class="s1">&#39;ec_pcsu&#39;</span><span class="p">,</span>  <span class="c1"># PC cold SU term</span>
                      <span class="s1">&#39;ec_pchsu&#39;</span><span class="p">,</span> <span class="c1"># PC hot SU term </span>
                      <span class="s1">&#39;ec_pcsd&#39;</span><span class="p">,</span>  <span class="c1"># PC SD term</span>
                      <span class="s1">&#39;ec_pcr&#39;</span><span class="p">,</span>   <span class="c1"># PC ramping term</span>
                      <span class="s1">&#39;ec_pcer&#39;</span><span class="p">,</span>  <span class="c1"># PC excess ramping term</span>
                      <span class="s1">&#39;ec_nsu&#39;</span><span class="p">,</span>   <span class="c1"># LFR cold SU term</span>
                      <span class="s1">&#39;ec_nhsu&#39;</span><span class="p">,</span>  <span class="c1"># LFR hot SU term</span>
                      <span class="s1">&#39;ec_nsd&#39;</span><span class="p">,</span>   <span class="c1"># LFR SD term</span>
                      <span class="s1">&#39;ec_pcg&#39;</span><span class="p">,</span>   <span class="c1"># PC power generating term</span>
                      <span class="s1">&#39;ec_pcsb&#39;</span><span class="p">,</span>  <span class="c1"># PC SB term</span>
                      <span class="s1">&#39;ec_nt&#39;</span>     <span class="c1"># LFR thermal power generating term</span>
                      <span class="p">]</span>
        
        <span class="c1"># setting objective function coefficients</span>
        <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">coeff_list</span><span class="p">:</span>
            <span class="n">param_dict</span><span class="p">[</span><span class="n">coeff</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="n">coeff</span><span class="p">]</span> <span class="k">if</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
            
        <span class="c1">### Cost Parameters ###</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Cnuc&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">C_nuc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;USD/kWh&#39;</span><span class="p">)</span>  <span class="c1">#C^{nuc}: Operating cost of nuclear plant [\$/kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Cnsu&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">C_nsu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;USD&#39;</span><span class="p">)</span>      <span class="c1">#C^{nsu}: Penalty for nuclear cold start-up [\$/start]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Cnhsp&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">C_nhsp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;USD&#39;</span><span class="p">)</span>     <span class="c1">#C^{nhsp}: Penalty for nuclear hot start-up [\$/start]</span>

        <span class="k">return</span> <span class="n">param_dict</span></div>
        

<div class="viewcode-block" id="NuclearDispatchParamWrap.set_nuclear_parameters"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchParamWrap.set_nuclear_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_nuclear_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set parameters specific to the Nuclear Plant for Dispatch optimization</span>
<span class="sd">        </span>
<span class="sd">        This method calculates some parameters specific to the NuclearTES plant</span>
<span class="sd">        which are meant to be fixed throughout the simulation. </span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            param_dict (dict) : dictionary of Pyomo dispatch parameters</span>
<span class="sd">        Outputs:</span>
<span class="sd">            param_dict (dict) : updated dictionary of Pyomo dispatch parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># grabbing unit registry set up in GeneralDispatch</span>
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span> 
        
        <span class="n">dw_rec_pump</span>             <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;dw_nuc_pump&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">MW</span>   <span class="c1"># TODO: Pumping parasitic at design point reciever mass flow rate (MWe)</span>
        <span class="n">tower_piping_ht_loss</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;nuc_piping_ht_loss&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kW</span>   <span class="c1"># TODO: Tower piping heat trace full-load parasitic load (kWe) </span>
        <span class="n">q_nuc_standby_fraction</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;q_nuc_standby_frac&#39;</span><span class="p">]</span>        <span class="c1"># TODO: Nuclear standby energy consumption (fraction of design point thermal power)</span>
        <span class="n">q_nuc_shutdown_fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;q_nuc_shutdown_frac&#39;</span><span class="p">]</span>       <span class="c1"># TODO: Nuclear shutdown energy consumption (fraction of design point thermal power)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">deltanl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;rec_su_delay&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">hr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">En</span>     <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;rec_qf_delay&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kWh</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">kW</span> <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_nuc_design</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">Eu</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;tshours&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">hr</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_pb_design</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ln</span>     <span class="o">=</span> <span class="n">dw_rec_pump</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_nuc_design</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qnl</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;f_nuc_min&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_nuc_design</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">Qnsb</span>   <span class="o">=</span> <span class="n">q_nuc_standby_fraction</span>  <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_nuc_design</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">Qnsd</span>   <span class="o">=</span> <span class="n">q_nuc_shutdown_fraction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_nuc_design</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">Qnu</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">En</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltanl</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">Wnht</span>    <span class="o">=</span> <span class="n">tower_piping_ht_loss</span>
        
        <span class="c1">### CSP Field and Receiver Parameters ###</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;deltanl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltanl</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;hr&#39;</span><span class="p">)</span>  <span class="c1">#\delta^{nl}: Minimum time to start the nuclear plant [hr]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;En&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">En</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">)</span>       <span class="c1">#E^n: Required energy expended to start nuclear plant [kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Eu&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">)</span>       <span class="c1">#E^u: Thermal energy storage capacity [kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Ln&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ln</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>          <span class="c1">#L^n: Nuclear pumping power per unit power produced [kWe/kWt]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Qnl&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qnl</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">)</span>       <span class="c1">#Q^{nl}: Minimum operational thermal power delivered by nuclear [kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Qnsb&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qnsb</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">)</span>      <span class="c1">#Q^{nsb}: Required thermal power for nuclear standby [kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Qnsd&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qnsd</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">)</span>      <span class="c1">#Q^{nsd}: Required thermal power for nuclear shut down [kWt$\cdot$h] </span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Qnu&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qnu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">)</span>       <span class="c1">#Q^{nu}: Allowable power per period for nuclear start-up [kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Wnht&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Wnht</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">)</span>      <span class="c1">#W^{nht}: Nuclear piping heat trace parasitic loss [kWe]</span>
        
        <span class="k">return</span> <span class="n">param_dict</span></div>
    
    
<div class="viewcode-block" id="NuclearDispatchParamWrap.set_time_series_nuclear_parameters"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchParamWrap.set_time_series_nuclear_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_time_series_nuclear_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">,</span> <span class="n">updated_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set fixed costs of the Plant for Dispatch optimization</span>
<span class="sd">        </span>
<span class="sd">        This method calculates some time series parameters for the Plant operations, startup,</span>
<span class="sd">        standby, etc. These are NOT meant to be fixed, but updated at the beginning</span>
<span class="sd">        of every segment using the latest SSC outputs or to extract the next relevant</span>
<span class="sd">        segment of pricing arrays, efficiencies, etc. </span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            param_dict (dict) : dictionary of Pyomo dispatch parameters</span>
<span class="sd">            updated_dict (dict) : dictionary with updated SSC initial conditions from previous run  </span>
<span class="sd">        Outputs:</span>
<span class="sd">            param_dict (dict) : updated dictionary of Pyomo dispatch parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#MAKE SURE TO CALL THIS METHOD AFTER THE NUCLEAR PARAMETERS </span>
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span>
        
        <span class="c1"># differentiating between first and updated runs</span>
        <span class="k">if</span> <span class="n">updated_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first_run</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span> <span class="o">=</span> <span class="n">updated_dict</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first_run</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1"># thermal power and startup params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Dnsu</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PySAM_dict</span><span class="p">[</span><span class="s1">&#39;Dnsu&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">hr</span>   <span class="c1"># Minimum time to start the nuclear plant (hr)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qin_nuc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;Q_nuc_thermal&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MW</span>    <span class="c1"># value here taken from a previous Plant-SSC run</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Qin_nuc</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Delta&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Qin_nuc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;Q_nuc_thermal&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;Q_nuc_thermal&#39;</span><span class="p">]]</span> <span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MW</span>
        
        <span class="c1"># instantiating arrays</span>
        <span class="n">n</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Delta</span><span class="p">)</span>
        <span class="n">delta_ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        
        <span class="c1"># loop to set startup nuclear params (probably won&#39;t need, keeping it for unit testing?)</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">Ein</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qin_nuc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="n">E_compare</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">En</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kWh</span><span class="p">,</span> <span class="n">Ein</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">delta_ns</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span> <span class="n">E_compare</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dnsu</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Delta</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_ns</span>   <span class="o">=</span> <span class="n">delta_ns</span>

        <span class="c1">### Time series CSP Parameters ###</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;delta_ns&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_ns</span>      <span class="c1">#\delta^{ns}_{t}: Estimated fraction of period $t$ required for nuclear start-up [-]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;Qin_nuc&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qin_nuc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">)</span>  <span class="c1">#Q^{in}_{t}: Available thermal power generated by the nuclear plant in period $t$ [kWt]</span>
        
        <span class="k">return</span> <span class="n">param_dict</span></div>


<div class="viewcode-block" id="NuclearDispatchParamWrap.set_initial_state"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchParamWrap.set_initial_state">[docs]</a>    <span class="k">def</span> <span class="nf">set_initial_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">,</span> <span class="n">updated_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plant</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set the initial state of the Plant before Dispatch optimization</span>
<span class="sd">        </span>
<span class="sd">        This method uses SSC data to set the initial state of the Plant before Dispatch</span>
<span class="sd">        optimization in Pyomo. This method is called in two ways: once before starting </span>
<span class="sd">        the simulation loop, in which case it only uses values from the SSC_dict portion</span>
<span class="sd">        of the given JSON script. The method is also called within the simulation loop</span>
<span class="sd">        to update the initial state parameters based on the ending conditions of the </span>
<span class="sd">        previous simulation segment (provided by SSC). </span>
<span class="sd">        </span>
<span class="sd">        TODO: can we just input another dictionary instead of passing the full Plant?</span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            param_dict (dict)    : dictionary of Pyomo dispatch parameters</span>
<span class="sd">            updated_dict (dict)  : dictionary with updated SSC initial conditions from previous run</span>
<span class="sd">            plant (obj)          : the full PySAM Plant object. </span>
<span class="sd">            npts (int)           : length of the SSC horizon</span>
<span class="sd">        Outputs:</span>
<span class="sd">            param_dict (dict) : updated dictionary of Pyomo dispatch parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span>
        
        <span class="c1"># First filling out initial states from GeneralDispatcher</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_initial_state</span><span class="p">(</span><span class="n">param_dict</span><span class="p">,</span> <span class="n">updated_dict</span><span class="p">,</span> <span class="n">plant</span><span class="p">,</span> <span class="n">npts</span> <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">updated_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first_run</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span> <span class="o">=</span> <span class="n">updated_dict</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first_run</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1"># TES masses, temperatures, specific heat</span>
        <span class="n">m_hot</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_tes_design</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;csp.pt.tes.init_hot_htf_percent&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>        <span class="c1"># Available active mass in hot tank</span>
        <span class="n">T_tes_hot_init</span>  <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;T_tank_hot_init&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">celsius</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degK&#39;</span><span class="p">)</span>
        <span class="n">T_tes_init</span>  <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">T_tes_hot_init</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_htf_cold</span><span class="p">)</span>
        <span class="n">cp_tes_init</span> <span class="o">=</span> <span class="n">SSCHelperMethods</span><span class="o">.</span><span class="n">get_cp_htf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">T_tes_init</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSC_dict</span><span class="p">[</span><span class="s1">&#39;rec_htf&#39;</span><span class="p">]</span> <span class="p">)</span>
        
        <span class="c1"># important parameters</span>
        <span class="n">s_current</span>          <span class="o">=</span> <span class="n">m_hot</span> <span class="o">*</span> <span class="n">cp_tes_init</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_tes_hot_init</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_htf_cold</span><span class="p">)</span> <span class="c1"># TES capacity</span>
        <span class="n">s0</span>                 <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Eu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">),</span> <span class="n">s_current</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">)</span>  <span class="p">)</span>
        <span class="n">yn0</span>                <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;nuc_op_mode_initial&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ynsb0</span>              <span class="o">=</span> <span class="kc">False</span>   <span class="c1"># We don&#39;t have standby mode for either Nuclear or CSP</span>
        <span class="n">ynsu0</span>              <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;nuc_op_mode_initial&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t_nuc</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;nuc_startup_time_remain_init&#39;</span><span class="p">]</span>
        <span class="n">t_nuc_suinitremain</span> <span class="o">=</span> <span class="n">t_nuc</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span> <span class="n">t_nuc</span> <span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="n">e_nuc</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_Plant</span><span class="p">[</span><span class="s1">&#39;nuc_startup_energy_remain_init&#39;</span><span class="p">]</span>
        <span class="n">e_nuc_suinitremain</span> <span class="o">=</span> <span class="n">e_nuc</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span> <span class="n">e_nuc</span> <span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="n">nuc_accum_time</span>     <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">hr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dnsu</span> <span class="o">-</span> <span class="n">t_nuc_suinitremain</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">hr</span> <span class="p">)</span>
        <span class="n">nuc_accum_energy</span>   <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Wh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">En</span>   <span class="o">-</span> <span class="n">e_nuc_suinitremain</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Wh</span> <span class="p">)</span>

        <span class="c1"># defining parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s0</span>    <span class="o">=</span> <span class="n">s0</span>              <span class="c1">#s_0: Initial TES reserve quantity  [kWt$\cdot$h]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yn0</span>   <span class="o">=</span> <span class="n">yn0</span>             <span class="c1">#y^r_0: 1 if nuclear is generating ``usable&#39;&#39; thermal power initially, 0 otherwise </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ynsb0</span> <span class="o">=</span> <span class="n">ynsb0</span>           <span class="c1">#y^{nsb}_0: 1 if nuclear is in standby mode initially, 0 otherwise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ynsu0</span> <span class="o">=</span> <span class="n">ynsu0</span>           <span class="c1">#y^{nsu}_0: 1 if nuclear is in starting up initially, 0 otherwise</span>
        
        <span class="c1"># Initial nuclear startup energy inventory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unsu0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nuc_accum_energy</span><span class="p">,</span> <span class="n">nuc_accum_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qnu</span><span class="p">)</span>  <span class="c1"># Note, SS receiver model in ssc assumes full available power is used for startup (even if, time requirement is binding)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsu0</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.e-6</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">En</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unsu0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">En</span>

        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;s0&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s0</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">)</span>    <span class="c1">#s_0: Initial TES reserve quantity  [kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;unsu0&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsu0</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kWh&#39;</span><span class="p">)</span> <span class="c1">#u^{nsu}_0: Initial nuclear start-up energy inventory [kWt$\cdot$h]</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;yn0&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yn0</span>             <span class="c1">#y^n_0: 1 if nuclear is generating ``usable&#39;&#39; thermal power initially, 0 otherwise</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;ynsb0&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ynsb0</span>           <span class="c1">#y^{nsb}_0: 1 if nuclear is in standby mode initially, 0 otherwise</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;ynsu0&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ynsu0</span>           <span class="c1">#y^{nsu}_0: 1 if nuclear is in starting up initially, 0 otherwise</span>
        
        <span class="k">return</span> <span class="n">param_dict</span></div></div>
    
    
<span class="c1"># =============================================================================</span>
<span class="c1"># Dispatch Outputs</span>
<span class="c1"># =============================================================================</span>
  
<div class="viewcode-block" id="NuclearDispatchOutputs"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchOutputs">[docs]</a><span class="k">class</span> <span class="nc">NuclearDispatchOutputs</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The NuclearDispatchOutputs class is meant to handle outputs from a given,</span>
<span class="sd">    solved Pyomo Dispatch model. It returns desired outputs in appropriate formats</span>
<span class="sd">    and syntaxes for PostProcessing and linking simulation segments between Pyomo</span>
<span class="sd">    and SSC calls. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="NuclearDispatchOutputs.get_dispatch_targets_from_Pyomo"><a class="viewcode-back" href="../../../simulations.dispatch.html#simulations.dispatch.NuclearDispatch.NuclearDispatchOutputs.get_dispatch_targets_from_Pyomo">[docs]</a>    <span class="k">def</span> <span class="nf">get_dispatch_targets_from_Pyomo</span><span class="p">(</span><span class="n">dispatch_model</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">N_full</span><span class="p">,</span> <span class="n">run_loop</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set fixed costs of the Plant</span>
<span class="sd">        </span>
<span class="sd">        This method parses through the solved Pyomo model for Dispatch optimization</span>
<span class="sd">        and extracts results that are used as Dispatch Targets in the *SAME* simulation</span>
<span class="sd">        segment but in SSC rather than Pyomo. If we&#39;re not running a loop, we can</span>
<span class="sd">        still update SSC only I guess this happens once for whatever Pyomo horizon</span>
<span class="sd">        is defined (this might not be a feature we keep long-term, perhaps only for</span>
<span class="sd">                    debugging). </span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">            dispatch_model (Pyomo model) : solved Pyomo Dispatch model (ConcreteModel)</span>
<span class="sd">            horizon (float Quant)        : length of time of horizon, whether SSC or Pyomo (in hours)</span>
<span class="sd">            N_full (int)                 : length of full simulation time (in hours, no Quant)</span>
<span class="sd">            run_loop (bool)              : flag to determine if simulation is segmented</span>
<span class="sd">        Outputs:</span>
<span class="sd">            disp_targs (dict) : dictionary of dispatch target arrays for use in SSC </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">dm</span> <span class="o">=</span> <span class="n">dispatch_model</span>
        
        <span class="c1"># range of pyomo and SSC horizon times</span>
        <span class="n">t_pyomo</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">T</span>
        <span class="n">f_ind</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">horizon</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;hr&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span> <span class="p">)</span> <span class="c1"># index in hours of final horizon (e.g. 24)</span>
        <span class="n">t_horizon</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">f_ind</span><span class="p">)</span>
        
        <span class="c1"># if we&#39;re not running a loop, define a list of 0s to pad the output so it matches full array size</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">run_loop</span><span class="p">:</span>
            <span class="n">N_leftover</span> <span class="o">=</span> <span class="n">N_full</span> <span class="o">-</span> <span class="n">f_ind</span>
            <span class="n">empty_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N_leftover</span>
        
        <span class="c1">#----Receiver Binary Outputs----</span>
        <span class="n">yn</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>   <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span>
        <span class="n">ynsu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span>
        <span class="n">ynsb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span>
        
        <span class="c1">#----Cycle Binary Outputs----</span>
        <span class="n">y</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span>
        <span class="n">ycsu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ycsu</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span>
        <span class="n">ycsb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span>
    
        <span class="c1">#----Cycle Thermal Power Utilization----</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>   <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span><span class="o">/</span><span class="mf">1000.</span> <span class="c1"># from kWt -&gt; MWt</span>
        
        <span class="c1">#----Thermal Capacity for Cycle Startup and Operation----</span>
        <span class="n">Qc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pe</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Qc</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pyomo</span><span class="p">])</span><span class="o">/</span><span class="mf">1000.</span> <span class="c1"># from kWt -&gt; MWt</span>
        <span class="n">Qu</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Qu</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="mf">1000.</span> <span class="c1"># from kWt -&gt; MWt</span>
    
        <span class="c1"># dispatch target -- nuclear startup/standby binaries</span>
        <span class="n">is_nuc_su_allowed_in</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">yn</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">ynsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_horizon</span><span class="p">]</span>  <span class="c1"># Nuclear on, startup, or standby</span>
        <span class="n">is_nuc_sb_allowed_in</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">ynsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span>                     <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_horizon</span><span class="p">]</span>  <span class="c1"># Nuclear standby</span>
        
        <span class="c1"># dispatch target -- cycle startup/standby binaries</span>
        <span class="n">is_pc_su_allowed_in</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">ycsu</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_horizon</span><span class="p">]</span>  <span class="c1"># Cycle on or startup</span>
        <span class="n">is_pc_sb_allowed_in</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">ycsb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span>          <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_horizon</span><span class="p">]</span>  <span class="c1"># Cycle standby</span>
    
        <span class="c1"># dispatch target -- cycle thermal inputs and capacities</span>
        <span class="n">q_pc_target_su_in</span>    <span class="o">=</span> <span class="p">[</span><span class="n">Qc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="k">if</span> <span class="n">ycsu</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="k">else</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_horizon</span><span class="p">]</span>
        <span class="n">q_pc_target_on_in</span>    <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>                              <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_horizon</span><span class="p">]</span>
        <span class="n">q_pc_max_in</span>          <span class="o">=</span> <span class="p">[</span><span class="n">Qu</span>                                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_horizon</span><span class="p">]</span>
        
        <span class="c1"># empty dictionary for output</span>
        <span class="n">disp_targs</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># if we&#39;re running full simulation in steps, save SSC horizon portion of Pyomo horizon results</span>
        <span class="k">if</span> <span class="n">run_loop</span><span class="p">:</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_rec_su_allowed_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_nuc_su_allowed_in</span> 
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_rec_sb_allowed_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_nuc_sb_allowed_in</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_pc_su_allowed_in&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">is_pc_su_allowed_in</span> 
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_pc_sb_allowed_in&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">is_pc_sb_allowed_in</span>  
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;q_pc_target_su_in&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">q_pc_target_su_in</span>  
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;q_pc_target_on_in&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">q_pc_target_on_in</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;q_pc_max_in&#39;</span><span class="p">]</span>          <span class="o">=</span> <span class="n">q_pc_max_in</span>
        <span class="c1"># if we&#39;re running full simulation all at once, need arrays to match size of full sim</span>
        <span class="c1"># TODO: is this a feature we want in the long term? Or just for debugging the first Pyomo call?</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_rec_su_allowed_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">is_nuc_su_allowed_in</span> <span class="p">,</span> <span class="n">empty_array</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_rec_sb_allowed_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">is_nuc_sb_allowed_in</span> <span class="p">,</span> <span class="n">empty_array</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_pc_su_allowed_in&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">is_pc_su_allowed_in</span>  <span class="p">,</span> <span class="n">empty_array</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;is_pc_sb_allowed_in&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">is_pc_sb_allowed_in</span>  <span class="p">,</span> <span class="n">empty_array</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;q_pc_target_su_in&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">q_pc_target_su_in</span>    <span class="p">,</span> <span class="n">empty_array</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;q_pc_target_on_in&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">q_pc_target_on_in</span>    <span class="p">,</span> <span class="n">empty_array</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">disp_targs</span><span class="p">[</span><span class="s1">&#39;q_pc_max_in&#39;</span><span class="p">]</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">q_pc_max_in</span>          <span class="p">,</span> <span class="n">empty_array</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            
        <span class="k">return</span> <span class="n">disp_targs</span></div></div>
    

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">NE-2 Simulations  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">simulations.dispatch.NuclearDispatch</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Gabriel J. Soto, Una Baker, Grace Stanke, Ben Lindley, Mike Wagner.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>